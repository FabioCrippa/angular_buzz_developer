<!-- ‚úÖ VERS√ÉO CORRIGIDA COMPLETA -->
<div class="dashboard-container">

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Carregando seu dashboard...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="hasError" class="error-container">
    <mat-icon class="error-icon">error_outline</mat-icon>
    <h2 class="error-title">Ops! Algo deu errado</h2>
    <p class="error-message">{{ errorMessage }}</p>
    <button class="retry-button" (click)="reloadData()">
      <mat-icon>refresh</mat-icon>
      Tentar Novamente
    </button>
  </div>

  <!-- Main Content -->
  <div *ngIf="!isLoading && !hasError">
    
    <!-- ‚úÖ HEADER PREMIUM -->
    <header class="dashboard-header">
      <h1 class="dashboard-title">{{ appInfo.name }}</h1>
      <p class="dashboard-subtitle">{{ appInfo.description }}</p>

      <!-- ‚úÖ STATS CORRIGIDAS -->
      <div class="stats-overview">
        <div class="stat-item">
          <span class="stat-number" [attr.data-number]="areas.length">
            {{ areas.length }}
          </span>
          <span class="stat-label">√Åreas</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" [attr.data-number]="getAvailableAreasCount()">
            {{ getAvailableAreasCount() }}
          </span>
          <span class="stat-label">Dispon√≠veis</span>
        </div>
      </div>
    </header>
    
    <!-- üéÆ GAMIFICA√á√ÉO - ESTAT√çSTICAS DO USU√ÅRIO -->
    <section class="gamification-section" *ngIf="userProgress && !isLoadingGamification">
      <h2 class="section-title">
        <mat-icon class="title-icon">emoji_events</mat-icon>
        Seu Progresso
      </h2>
      
      <div class="gamification-grid">
        
        <!-- Level Card -->
        <div class="gamification-card level-card">
          <div class="card-header">
            <mat-icon class="card-icon">military_tech</mat-icon>
            <span class="card-title">N√≠vel</span>
          </div>
          <div class="card-body">
            <div class="level-display">
              <span class="level-number">{{ userLevel }}</span>
              <span class="level-name">{{ levelName }}</span>
            </div>
            <div class="xp-bar">
              <div class="xp-fill" [style.width.%]="levelProgress"></div>
              <span class="xp-text">{{ userXP }} XP</span>
            </div>
            <div class="xp-info">
              <span>{{ xpToNextLevel }} XP para pr√≥ximo n√≠vel</span>
            </div>
          </div>
        </div>
        
        <!-- Streak Card -->
        <div class="gamification-card streak-card">
          <div class="card-header">
            <mat-icon class="card-icon fire">local_fire_department</mat-icon>
            <span class="card-title">Sequ√™ncia</span>
          </div>
          <div class="card-body">
            <div class="streak-display">
              <span class="streak-number">{{ userProgress.streak }}</span>
              <span class="streak-label">dias</span>
            </div>
            <p class="streak-message" *ngIf="userProgress.streak > 0">
              üî• Continue assim! Mantenha sua sequ√™ncia de estudos.
            </p>
            <p class="streak-message" *ngIf="userProgress.streak === 0">
              üí™ Complete um quiz hoje para iniciar sua sequ√™ncia!
            </p>
          </div>
        </div>
        
        <!-- Stats Card -->
        <div class="gamification-card stats-card">
          <div class="card-header">
            <mat-icon class="card-icon">assessment</mat-icon>
            <span class="card-title">Estat√≠sticas</span>
          </div>
          <div class="card-body">
            <div class="stat-row">
              <span class="stat-label">Quizzes Completos</span>
              <span class="stat-value">{{ userProgress.totalQuizzes }}</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Taxa de Acerto</span>
              <span class="stat-value">
                {{ userProgress.totalQuestions > 0 ? ((userProgress.correctAnswers / userProgress.totalQuestions) * 100).toFixed(1) : 0 }}%
              </span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Tempo de Estudo</span>
              <span class="stat-value">{{ userProgress.studyTimeMinutes }} min</span>
            </div>
          </div>
        </div>
        
        <!-- Recent Activity Card -->
        <div class="gamification-card activity-card">
          <div class="card-header">
            <mat-icon class="card-icon">history</mat-icon>
            <span class="card-title">Atividade Recente</span>
          </div>
          <div class="card-body">
            <div class="recent-quiz" *ngFor="let quiz of recentQuizzes.slice(0, 3)">
              <div class="quiz-info">
                <span class="quiz-area">{{ quiz.area }}</span>
                <span class="quiz-score" [class.high-score]="quiz.score >= 80">{{ quiz.score }}%</span>
              </div>
              <span class="quiz-date">{{ getRelativeTime(quiz.completedAt) }}</span>
            </div>
            <p class="no-activity" *ngIf="recentQuizzes.length === 0">
              Nenhuma atividade recente. Complete um quiz para come√ßar!
            </p>
          </div>
        </div>
        
      </div>
    </section>

    <!-- ‚úÖ QUICK ACTIONS PREMIUM -->
    <section class="quick-actions-section">
      <h2 class="section-title">A√ß√µes R√°pidas</h2>
      <div class="quick-actions-grid">
        
        <div class="quick-action-card" (click)="startRandomQuiz()">
          <div class="action-icon">
            <mat-icon>shuffle</mat-icon>
          </div>
          <h3 class="action-title">Quiz Aleat√≥rio</h3>
          <p class="action-description">Quest√µes de todas as √°reas dispon√≠veis</p>
        </div>
        
        <div class="quick-action-card" (click)="viewProgress()">
          <div class="action-icon">
            <mat-icon>trending_up</mat-icon>
          </div>
          <h3 class="action-title">Meu Progresso</h3>
          <p class="action-description">Acompanhe sua evolu√ß√£o detalhada</p>
        </div>
        
        <div class="quick-action-card" (click)="viewFavorites()">
          <div class="action-icon">
            <mat-icon>favorite</mat-icon>
          </div>
          <h3 class="action-title">Favoritos</h3>
          <p class="action-description">Suas quest√µes marcadas como favoritas</p>
        </div>
        
        <!-- ‚úÖ UPGRADE CARD PREMIUM -->
        <div class="quick-action-card upgrade-card" (click)="navigateToUpgrade()">
          <div class="action-icon">
            <mat-icon class="crown-icon">emoji_events</mat-icon>
          </div>
          <h3 class="action-title">Upgrade Premium</h3>
          <p class="action-description">Acesso ilimitado a todas as funcionalidades</p>
          <div class="upgrade-badge">
            <div class="premium-chip">
              <mat-icon>stars</mat-icon>
              7 dias gr√°tis
            </div>
          </div>
        </div>
        
      </div>
    </section>

    <!-- ‚úÖ STUDY AREAS - CARDS PREMIUM -->
    <section class="study-areas-section">
      <h2 class="section-title">√Åreas de Estudo</h2>
      
      <div class="areas-grid">
        <div 
          *ngFor="let area of areas; trackBy: trackByAreaName" 
          class="area-card"
          [class.unavailable]="!area.available"
          (click)="navigateToArea(area.name)"
        >
          
          <!-- ‚úÖ AREA HEADER -->
          <div class="area-header">
            <div class="area-icon">
              {{ getAreaIcon(area.name) }}
            </div>
            <div class="area-info">
              <h3>{{ area.displayName }}</h3>
            </div>
          </div>

          <!-- ‚úÖ DESCRIPTION -->
          <p class="area-description">{{ area.description }}</p>
          
          <!-- ‚úÖ SUBJECTS PREVIEW -->
          <p class="subjects-preview" *ngIf="area.subjects && area.subjects.length > 0">
            {{ area.subjects.slice(0, 3).join(', ') }}
            <span *ngIf="area.subjects.length > 3">...</span>
          </p>

        </div>
      </div>
    </section>

  </div>
</div>