<!-- âœ… ÃREA PREMIUM/FREE - SEM ANGULAR MATERIAL -->
<div class="area-container" *ngIf="!isLoading && !hasError && areaData">

  <!-- âœ… LOADING STATE -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
    <h3>Carregando Ã¡rea de estudo...</h3>
    <p>Preparando questÃµes e conteÃºdo</p>
  </div>

  <!-- âœ… ERROR STATE -->
  <div *ngIf="hasError" class="error-container">
    <div class="error-icon">âš ï¸</div>
    <h2 class="error-title">Ãrea nÃ£o encontrada</h2>
    <p class="error-message">{{ errorMessage }}</p>
    <div class="error-actions">
      <button class="btn btn-outline" (click)="navigateToDashboard()">
        <span class="btn-icon">ğŸ </span>
        Voltar ao Dashboard
      </button>
      <button class="btn btn-primary" (click)="reloadData()">
        <span class="btn-icon">ğŸ”„</span>
        Tentar Novamente
      </button>
    </div>
  </div>

  <!-- âœ… MAIN CONTENT -->
  <div *ngIf="!isLoading && !hasError && areaData">

    <!-- ğŸ·ï¸ PREMIUM STATUS BAR -->
    <div class="premium-status-bar" [class]="isPremium ? 'premium' : 'free'">
      <div class="status-content">
        <!-- Premium User -->
        <div *ngIf="isPremium" class="premium-indicator">
          <span class="premium-crown">ğŸ‘‘</span>
          <span class="status-text">
            <strong>UsuÃ¡rio Premium</strong> - Acesso completo a todos os recursos
          </span>
          <span class="unlimited-badge">ILIMITADO</span>
        </div>
        
        <!-- Free User -->
        <div *ngIf="!isPremium" class="free-indicator">
          <span class="free-icon">â„¹ï¸</span>
          <span class="status-text">
            <strong>UsuÃ¡rio Free</strong> - {{ remainingQuizzes }} quiz{{ remainingQuizzes !== 1 ? 's' : '' }} restante{{ remainingQuizzes !== 1 ? 's' : '' }} hoje
          </span>
          <button class="btn btn-upgrade" (click)="navigateToUpgrade()">
            <span class="btn-icon">â­</span>
            Upgrade Premium
          </button>
        </div>
      </div>
      
      <!-- ğŸ§ª BOTÃƒO DE TESTE (remover em produÃ§Ã£o) -->
      <button class="test-toggle" (click)="togglePremiumForTesting()">
        {{ isPremium ? 'â­' : 'ğŸŒŸ' }}
      </button>
    </div>

    <!-- ğŸ“š BREADCRUMB -->
    <div class="breadcrumb">
      <button class="breadcrumb-item" (click)="navigateToDashboard()">
        <span class="breadcrumb-icon">ğŸ </span>
        Dashboard
      </button>
      <span class="breadcrumb-separator">â€º</span>
      <span class="breadcrumb-current">{{ areaData.displayName }}</span>
    </div>

    <!-- ğŸ¯ AREA HEADER -->
    <header class="area-header" [style.background]="'linear-gradient(135deg, ' + areaData.color + ', ' + areaData.color + 'CC)'">
      <div class="header-content">
        <div class="header-main">
          <div class="area-icon-large">{{ areaData.icon }}</div>
          <div class="area-info">
            <h1 class="area-title">{{ areaData.displayName }}</h1>
            <p class="area-description">{{ areaData.description }}</p>
            <div class="area-meta">
              <span class="meta-item">
                <span class="meta-icon">â“</span>
                {{ areaData.totalQuestions }} questÃµes
              </span>
              <span class="meta-item">
                <span class="meta-icon">ğŸ“š</span>
                {{ areaData.subjects.length }} assuntos
              </span>
            </div>
          </div>
        </div>
        <div class="header-actions">
          <button class="btn btn-outline-white" (click)="navigateToFavorites()">
            <span class="btn-icon">â¤ï¸</span>
            Favoritos
          </button>
          
          <!-- Quiz Button com validaÃ§Ã£o Premium -->
          <button 
            class="btn btn-primary-white"
            (click)="startAreaQuiz()"
            [disabled]="!canTakeQuiz"
            [class.disabled]="!canTakeQuiz"
          >
            <span class="btn-icon">â–¶ï¸</span>
            Quiz da Ãrea
            <span *ngIf="!isPremium && remainingQuizzes > 0" class="quiz-count">({{ remainingQuizzes }})</span>
          </button>
        </div>
      </div>
    </header>

    <!-- ğŸš« LIMITE DIÃRIO ATINGIDO -->
    <div *ngIf="!isPremium && !canTakeQuiz" class="limit-warning">
      <span class="warning-icon">â°</span>
      <div class="warning-content">
        <h3>Limite diÃ¡rio atingido!</h3>
        <p>VocÃª utilizou todos os seus 5 quizzes gratuitos de hoje. Volte amanhÃ£ ou faÃ§a upgrade para Premium!</p>
        <button class="btn btn-upgrade" (click)="navigateToUpgrade()">
          <span class="btn-icon">â­</span>
          Quizzes Ilimitados - Premium
        </button>
      </div>
    </div>

    <!-- ğŸ“Š USER PROGRESS -->
    <section class="progress-section">
      <div class="section-header">
        <h2 class="section-title">
          <span class="section-icon">ğŸ“ˆ</span>
          Seu Progresso
        </h2>
        <!-- Premium Badge -->
        <div *ngIf="!isPremium" class="premium-feature-badge" title="EstatÃ­sticas avanÃ§adas disponÃ­veis no Premium">
          <span class="premium-badge-icon">ğŸ‘‘</span>
          <span>EstatÃ­sticas Premium</span>
        </div>
      </div>
      
      <div class="progress-grid">
        <div class="progress-card completed-card">
          <div class="progress-icon">âœ…</div>
          <div class="progress-content">
            <span class="progress-number">{{ areaData.userProgress.completed }}</span>
            <span class="progress-label">QuestÃµes Resolvidas</span>
            <span class="progress-sublabel">de {{ areaData.totalQuestions }}</span>
          </div>
        </div>

        <div class="progress-card accuracy-card">
          <div class="progress-icon">ğŸ“Š</div>
          <div class="progress-content">
            <span class="progress-number">{{ areaData.userProgress.accuracy }}%</span>
            <span class="progress-label">Taxa de Acerto</span>
            <span class="progress-sublabel">mÃ©dia geral</span>
          </div>
        </div>

        <div class="progress-card time-card">
          <div class="progress-icon">â±ï¸</div>
          <div class="progress-content">
            <span class="progress-number">{{ areaData.userProgress.timeSpent }}</span>
            <span class="progress-label">Tempo de Estudo</span>
            <span class="progress-sublabel">total investido</span>
          </div>
        </div>

        <div class="progress-card level-card">
          <div class="progress-icon">ğŸ†</div>
          <div class="progress-content">
            <span class="progress-number">{{ getProgressPercentage() }}%</span>
            <span class="progress-label">Completude</span>
            <span class="progress-sublabel">da Ã¡rea</span>
          </div>
        </div>
      </div>

      <!-- Progress Bar Visual -->
      <div class="overall-progress">
        <div class="progress-bar-container">
          <div class="progress-bar">
            <div 
              class="progress-fill" 
              [style.width.%]="getProgressPercentage()"
              [style.background-color]="areaData.color"
            ></div>
          </div>
          <span class="progress-text">
            {{ areaData.userProgress.completed }}/{{ areaData.totalQuestions }} questÃµes completadas
          </span>
        </div>
      </div>
    </section>

    <!-- ğŸ” FILTERS & SEARCH -->
    <section class="filters-section">
      <div class="filters-header">
        <h2 class="section-title">
          <span class="section-icon">ğŸ”„</span>
          QuestÃµes para Revisar
          <span class="title-count" *ngIf="hasWrongQuestions">({{ wrongQuestionsCount }})</span>
        </h2>
        <div class="results-count">
          <span class="count-badge wrong-questions" *ngIf="hasWrongQuestions">
            <span class="badge-icon">ğŸ”„</span>
            {{ filteredQuestions.length }} questÃµes para revisar
          </span>
          <span class="count-badge no-errors" *ngIf="!hasWrongQuestions">
            <span class="badge-icon">âœ…</span>
            Nenhuma questÃ£o para revisar
          </span>
        </div>
      </div>

      <div class="filters-content">
        <!-- Search Bar -->
        <div class="search-group">
          <span class="search-icon">ğŸ”</span>
          <input 
            type="text" 
            placeholder="Buscar questÃµes, assuntos, tags..." 
            [(ngModel)]="searchQuery"
            class="search-input"
          >
        </div>

        <!-- Filter Controls com Premium Lock -->
        <div class="filter-controls" [class.premium-locked]="!isPremium">
          <div class="filter-group">
            <label class="filter-label">Assunto:</label>
            <select 
              [(ngModel)]="selectedSubject" 
              class="filter-select"
              [disabled]="!isPremium && !premiumService.canUseAdvancedFilters()"
            >
              <option value="all">Todos os Assuntos</option>
              <option *ngFor="let subject of areaData.subjects" [value]="subject">
                {{ subject }}
              </option>
            </select>
          </div>

          <div class="filter-group">
            <label class="filter-label">Dificuldade:</label>
            <select 
              [(ngModel)]="selectedDifficulty" 
              class="filter-select"
              [disabled]="!isPremium && !premiumService.canUseAdvancedFilters()"
            >
              <option value="all">Todas</option>
              <option value="FÃ¡cil">FÃ¡cil ({{ areaData.difficulty.easy }})</option>
              <option value="MÃ©dio">MÃ©dio ({{ areaData.difficulty.medium }})</option>
              <option value="DifÃ­cil">DifÃ­cil ({{ areaData.difficulty.hard }})</option>
            </select>
          </div>

          <div class="filter-group">
            <label class="filter-label">Ordenar por:</label>
            <select 
              [(ngModel)]="sortBy" 
              class="filter-select"
              [disabled]="!isPremium && !premiumService.canUseAdvancedFilters()"
            >
              <option value="popularity">Mais Populares</option>
              <option value="difficulty">Por Dificuldade</option>
              <option value="subject">Por Assunto</option>
              <option value="recent">Mais Recentes</option>
            </select>
          </div>

          <button 
            class="btn btn-icon-only"
            title="Limpar filtros"
            (click)="clearFilters()"
            [disabled]="!isPremium && !premiumService.canUseAdvancedFilters()"
          >
            <span class="btn-icon">ğŸ—‘ï¸</span>
          </button>

          <!-- Premium Lock Overlay -->
          <div *ngIf="!isPremium" class="premium-lock-overlay" (click)="navigateToUpgrade()">
            <span class="lock-icon">ğŸ”’</span>
            <span class="lock-text">Filtros Premium</span>
          </div>
        </div>

        <!-- Smart Quiz Section -->
        <div class="smart-quiz-section">
          <!-- Indicador do Modo Inteligente -->
          <div class="smart-mode-indicator">
            <div class="mode-badge" [class]="getUserMode()">
              <span class="mode-icon">{{ getModeIcon() }}</span>
              <span>{{ getModeText() }}</span>
            </div>
            <p class="mode-description">{{ getModeDescription() }}</p>
          </div>

          <!-- BotÃµes de Quiz -->
          <div class="quiz-options">
            <!-- Quiz Normal -->
            <div class="quiz-option-wrapper">
              <button 
                class="quiz-btn primary-quiz"
                (click)="startAreaQuiz()"
                [disabled]="!canTakeQuiz"
                [class.disabled]="!canTakeQuiz"
              >
                <span class="quiz-icon">â“</span>
                <div class="btn-content">
                  <span class="btn-title">Quiz Normal</span>
                  <span class="btn-subtitle">
                    <span *ngIf="isPremium">10 questÃµes aleatÃ³rias</span>
                    <span *ngIf="!isPremium">{{ remainingQuizzes }} restante{{ remainingQuizzes !== 1 ? 's' : '' }}</span>
                  </span>
                </div>
              </button>
              
              <!-- Aviso de limite -->
              <div *ngIf="!canTakeQuiz" class="quiz-limit-warning">
                <span class="warning-small-icon">â°</span>
                <span>Limite diÃ¡rio atingido</span>
              </div>
            </div>

            <!-- Quiz Inteligente - PREMIUM ONLY -->
            <div class="quiz-option-wrapper">
              <button 
                class="quiz-btn smart-quiz"
                [disabled]="!isPremium || getWrongQuestions().length === 0 || !canTakeQuiz"
                (click)="startWrongQuestionsQuiz()"
                [class.premium-locked]="!isPremium"
                [style.background-color]="isPremium ? areaData.color : '#ccc'"
              >
                <span class="quiz-icon">{{ isPremium ? 'ğŸ”„' : 'ğŸ”’' }}</span>
                <div class="btn-content">
                  <span class="btn-title">Quiz Inteligente</span>
                  <span class="btn-subtitle">
                    <span *ngIf="isPremium">{{ getSmartQuizSubtitle() }}</span>
                    <span *ngIf="!isPremium">Recurso Premium</span>
                  </span>
                </div>
                
                <!-- Premium Badge -->
                <div *ngIf="!isPremium" class="premium-badge">
                  <span>ğŸ‘‘</span>
                </div>
              </button>
              
              <!-- Upgrade Message -->
              <div *ngIf="!isPremium" class="upgrade-message">
                <span>Upgrade para desbloquear</span>
                <button class="btn btn-small btn-accent" (click)="navigateToUpgrade()">Premium</button>
              </div>
            </div>

            <!-- Quiz Filtrado - PREMIUM ONLY -->
            <div class="quiz-option-wrapper">
              <button 
                class="quiz-btn filter-quiz"
                (click)="startCustomQuiz()"
                [disabled]="!isPremium || filteredQuestions.length === 0 || !canTakeQuiz"
                [class.premium-locked]="!isPremium"
              >
                <span class="quiz-icon">{{ isPremium ? 'ğŸ›ï¸' : 'ğŸ”’' }}</span>
                <div class="btn-content">
                  <span class="btn-title">Quiz Filtrado</span>
                  <span class="btn-subtitle">
                    <span *ngIf="isPremium">{{ filteredQuestions.length }} questÃµes selecionadas</span>
                    <span *ngIf="!isPremium">Recurso Premium</span>
                  </span>
                </div>
                
                <!-- Premium Badge -->
                <div *ngIf="!isPremium" class="premium-badge">
                  <span>ğŸ‘‘</span>
                </div>
              </button>
              
              <!-- Upgrade Message -->
              <div *ngIf="!isPremium" class="upgrade-message">
                <span>Filtros avanÃ§ados no Premium</span>
                <button class="btn btn-small btn-accent" (click)="navigateToUpgrade()">Upgrade</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- âœ… INFO SECTION -->
    <div class="info-section" *ngIf="!hasWrongQuestions">
      <div class="info-card">
        <span class="info-icon">ğŸ’¡</span>
        <div class="info-content">
          <h3>Como funciona a RevisÃ£o Inteligente</h3>
          <p>
            Esta Ã¡rea mostra apenas as questÃµes que vocÃª errou, permitindo focar no que realmente precisa melhorar. 
            <strong>FaÃ§a alguns quizzes</strong> para comeÃ§ar a gerar sua lista personalizada de revisÃ£o!
          </p>
          <button 
            class="btn btn-primary"
            (click)="startAreaQuiz()"
            [disabled]="!canTakeQuiz"
          >
            <span class="btn-icon">â“</span>
            Fazer Primeiro Quiz
          </button>
        </div>
      </div>
    </div>

    <!-- ğŸ’ PREMIUM UPGRADE BANNER -->
    <div *ngIf="!isPremium" class="premium-upgrade-banner">
      <div class="banner-content">
        <div class="banner-icon">
          <span>ğŸ‘‘</span>
        </div>
        <div class="banner-text">
          <h3>Desbloqueie Todo o Potencial!</h3>
          <p>
            Quiz inteligente, filtros avanÃ§ados, estatÃ­sticas detalhadas e muito mais. 
            Acelere seu aprendizado com o Quizzfy Premium!
          </p>
        </div>
        <div class="banner-actions">
          <button class="btn btn-premium" (click)="navigateToUpgrade()">
            <span class="btn-icon">â­</span>
            Upgrade Premium
          </button>
        </div>
      </div>
    </div>

    <!-- ğŸ¯ QUICK ACTIONS (apenas para Premium) -->
    <section class="quick-actions-section" *ngIf="isPremium">
      <h2 class="section-title">
        <span class="section-icon">ğŸ‘‘</span>
        AÃ§Ãµes Premium
      </h2>
      
      <div class="quick-actions-grid">
        <div class="quick-action-card" (click)="startAreaQuiz()">
          <span class="action-icon">â“</span>
          <h3>Quiz Ilimitado</h3>
          <p>Quantos quizzes quiser, sem limites diÃ¡rios</p>
          <button class="btn btn-outline">Iniciar</button>
        </div>

        <div class="quick-action-card" (click)="startWrongQuestionsQuiz()" 
             [class.disabled]="getWrongQuestions().length === 0">
          <span class="action-icon" [style.color]="getWrongQuestions().length > 0 ? areaData.color : '#ccc'">
            ğŸ”„
          </span>
          <h3>Quiz Inteligente</h3>
          <p>{{ getSmartQuizDescription() }}</p>
          <button class="btn btn-outline" [disabled]="getWrongQuestions().length === 0">
            {{ getWrongQuestions().length > 0 ? 'Revisar' : 'Sem erros' }}
          </button>
        </div>

        <div class="quick-action-card premium-feature">
          <span class="action-icon">ğŸ“Š</span>
          <h3>EstatÃ­sticas AvanÃ§adas</h3>
          <p>AnÃ¡lise detalhada do seu desempenho</p>
          <button class="btn btn-outline">Ver EstatÃ­sticas</button>
        </div>

        <div class="quick-action-card premium-feature">
          <span class="action-icon">ğŸ“¥</span>
          <h3>Exportar Progresso</h3>
          <p>Download do seu histÃ³rico de estudos</p>
          <button class="btn btn-outline">Exportar</button>
        </div>
      </div>
    </section>

  </div>
</div>
