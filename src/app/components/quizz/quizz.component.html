<!--
  Container principal do quiz. Utiliza uma classe para facilitar a estiliza√ß√£o e garantir responsividade.
-->
<div class="quiz-container">
    
    <!-- ‚úÖ HEADER DO QUIZ -->
    <div class="quiz-header">
        <div class="quiz-info">
            <div class="quiz-category">
                <img src="assets/img/logo.png" alt="logo" style="width: 60px; margin-right: 1rem;">
                <span>{{ title }}</span>
            </div>
            <div class="quiz-progress" *ngIf="!finished">
                Quest√£o {{ questionIndex + 1 }} de {{ questions.length }} ({{ progress }}%)
            </div>
        </div>
        <div class="quiz-score" *ngIf="!finished">
            {{ progress }}%
        </div>
    </div>

    <!-- ‚úÖ CONTROLES DE √ÅUDIO -->
    <div style="text-align: center; margin-bottom: 2rem;">
        <button class="btn btn-secondary" (click)="playMusic()" style="margin-right: 1rem;">
            üéµ Tocar M√∫sica
        </button>
        <button class="btn btn-secondary" (click)="pauseMusic()">
            ‚è∏Ô∏è Pausar M√∫sica
        </button>
        <!-- YouTube Player (oculto) -->
        <div id="youtube-player" style="display: none;"></div>
    </div>

    <!-- ‚úÖ QUIZ ATIVO -->
    <div *ngIf="!finished && currentQuestion">
        
        <!-- ‚úÖ CART√ÉO DA PERGUNTA -->
        <div class="question-card">
            <div class="question-number">
                {{ questionIndex + 1 }}/{{ questions.length }}
            </div>
            
            <h2 class="question-text">{{ currentQuestion.question }}</h2>
            
            <!-- ‚úÖ BOT√ÉO OUVIR PERGUNTA -->
            <button 
                class="btn btn-secondary"
                (click)="readText(currentQuestion.question)"
                style="margin-bottom: 2rem; padding: 0.5rem 1rem;"
                title="Ouvir Pergunta"
                aria-label="Ouvir Pergunta"
            >
                üîä Ouvir Pergunta
            </button>

            <!-- ‚úÖ OP√á√ïES DE RESPOSTA -->
            <div class="answer-options">
                <div 
                    *ngFor="let option of currentQuestion.options; let i = index" 
                    class="answer-option"
                    [ngClass]="getOptionClass(option.alias)"
                    (click)="selectAnswer(option.alias)"
                    [attr.disabled]="showFeedback ? true : null"
                    [attr.aria-label]="'Escolher resposta ' + option.name"
                    tabindex="0"
                    role="button"
                >
                    <div class="option-letter">{{ getOptionLetter(i) }}</div>
                    <div class="option-text">{{ option.name }}</div>
                </div>
            </div>

            <!-- ‚úÖ FEEDBACK -->
            <div *ngIf="showFeedback">
                <!-- Status da Resposta -->
                <div style="margin-bottom: 1rem;">
                    <h3 *ngIf="isCorrectAnswer(selectedAnswer)" 
                        style="color: var(--success); text-align: center;">
                        ‚úÖ Correto!
                    </h3>
                    <h3 *ngIf="!isCorrectAnswer(selectedAnswer)" 
                        style="color: var(--danger); text-align: center;">
                        ‚ùå Resposta incorreta
                    </h3>
                </div>

                <!-- ‚úÖ EXPLICA√á√ÉO -->
                <div *ngIf="currentQuestion.explanation" class="explanation">
                    <div class="explanation-title">
                        üí° Explica√ß√£o
                    </div>
                    <p>{{ currentQuestion.explanation }}</p>
                </div>

                <!-- ‚úÖ DICA DE ENTREVISTA -->
                <div *ngIf="currentQuestion.interviewTip" class="interview-tip">
                    <div class="interview-tip-title">
                        üéØ Dica para Entrevista
                    </div>
                    <p>{{ currentQuestion.interviewTip }}</p>
                    <button 
                        class="btn btn-secondary"
                        (click)="readText(currentQuestion.interviewTip)"
                        style="margin-top: 1rem; padding: 0.5rem 1rem;"
                        title="Ouvir Dica"
                    >
                        üîä Ouvir Dica
                    </button>
                </div>
            </div>

            <!-- ‚úÖ A√á√ïES DO QUIZ -->
            <div class="quiz-actions">
                <!-- Finalizar Agora (s√≥ aparece antes do feedback) -->
                <button 
                    *ngIf="!showFeedback"
                    class="btn btn-secondary" 
                    (click)="finishQuiz()"
                >
                    ‚ùå Finalizar Agora
                </button>
                
                <!-- Pr√≥xima Quest√£o (s√≥ aparece ap√≥s feedback) -->
                <button 
                    *ngIf="showFeedback"
                    class="btn btn-primary" 
                    (click)="nextQuestion()"
                >
                    {{ questionIndex === questions.length - 1 ? 'üèÅ Finalizar Quiz' : '‚û°Ô∏è Pr√≥xima Quest√£o' }}
                </button>
            </div>
        </div>
    </div>

    <!-- ‚úÖ RESULTADO FINAL -->
    <div *ngIf="finished && quizResult" class="quiz-result">
        <h2>üéâ Quiz Finalizado!</h2>
        
        <!-- Pontua√ß√£o Principal -->
        <div class="result-score">{{ quizResult.percentage }}%</div>
        
        <p class="result-message">
            Voc√™ acertou {{ quizResult.score }} de {{ quizResult.total }} quest√µes!
        </p>

        <!-- Estat√≠sticas Detalhadas -->
        <div class="result-details">
            <div class="result-stat">
                <span class="stat-number">{{ quizResult.score }}</span>
                <span class="stat-label">Acertos</span>
            </div>
            
            <div class="result-stat">
                <span class="stat-number">{{ quizResult.total - quizResult.score }}</span>
                <span class="stat-label">Erros</span>
            </div>
            
            <div class="result-stat">
                <span class="stat-number">{{ quizResult.percentage }}%</span>
                <span class="stat-label">Desempenho</span>
            </div>
        </div>

        <!-- ‚úÖ RESULTADOS POR CATEGORIA -->
        <div *ngIf="quizResult.categoryResults.length > 0" style="margin-top: 2rem;">
            <h3 style="margin-bottom: 1.5rem; text-align: center;">üìä Desempenho por Categoria</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <div 
                    *ngFor="let categoryResult of quizResult.categoryResults"
                    style="background: var(--bg); padding: 1rem; border-radius: var(--radius); text-align: center; color: var(--text);"
                >
                    <h4 style="margin-bottom: 0.5rem; color: var(--text);">
                        {{ getCategoryTitle(categoryResult.category) }}
                    </h4>
                    <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary); margin-bottom: 0.5rem;">
                        {{ categoryResult.percentage }}%
                    </div>
                    <div style="font-size: 0.9rem; opacity: 0.7;">
                        {{ categoryResult.correct }}/{{ categoryResult.total }} quest√µes
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚úÖ A√á√ïES FINAIS -->
        <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 2rem; flex-wrap: wrap;">
            <button class="btn btn-primary" (click)="restartQuiz()">
                üîÑ Jogar Novamente
            </button>
            <button class="btn btn-secondary" (click)="goHome()">
                üè† Voltar ao In√≠cio
            </button>
        </div>
    </div>

    <!-- ‚úÖ LOADING -->
    <div *ngIf="!finished && !currentQuestion" class="quiz-loading">
        <div class="loading-spinner"></div>
        <h2>Carregando quiz...</h2>
        <p>Preparando suas quest√µes...</p>
    </div>

</div>

