<!--
  Container principal do quiz. Utiliza uma classe para facilitar a estiliza√ß√£o e garantir responsividade.
-->
<div class="quiz-container">
    
    <!-- ‚úÖ HEADER DO QUIZ -->
    <div class="quiz-header">
        <div class="quiz-info">
            <div class="quiz-category">
                <span>{{ title }}</span>
            </div>
            <div class="quiz-progress" *ngIf="!finished">
                Quest√£o {{ questionIndex + 1 }} de {{ questions.length }} ({{ progress }}%)
            </div>
        </div>
        <div class="quiz-score" *ngIf="!finished">
            {{ progress }}%
        </div>
    </div>

    <!-- ‚úÖ CONTROLES DE √ÅUDIO -->
    <div class="audio-controls">
        <button class="btn btn-secondary btn-audio" (click)="playMusic()">
            üéµ Tocar M√∫sica
        </button>
        <button class="btn btn-secondary btn-audio" (click)="pauseMusic()">
            ‚è∏Ô∏è Pausar M√∫sica
        </button>
        <!-- YouTube Player (oculto) -->
        <div id="youtube-player" class="youtube-hidden"></div>
    </div>

    <!-- ‚úÖ QUIZ ATIVO -->
    <div *ngIf="!finished && currentQuestion" class="quiz-active">
        
        <!-- ‚úÖ CART√ÉO DA PERGUNTA -->
        <div class="question-card">
            <div class="question-number">
                {{ questionIndex + 1 }}/{{ questions.length }}
            </div>
            
            <h2 class="question-text">{{ currentQuestion.question }}</h2>
            
            <!-- ‚úÖ BOT√ÉO OUVIR PERGUNTA -->
            <button 
                class="btn btn-secondary btn-listen"
                (click)="readText(currentQuestion.question)"
                title="Ouvir Pergunta"
                aria-label="Ouvir Pergunta"
            >
                üîä Ouvir Pergunta
            </button>

            <!-- ‚úÖ OP√á√ïES DE RESPOSTA -->
            <div class="answer-options">
                <div 
                    *ngFor="let option of currentQuestion.options; let i = index" 
                    class="answer-option"
                    [ngClass]="getOptionClass(option.alias)"
                    (click)="selectAnswer(option.alias)"
                    [attr.disabled]="showFeedback ? true : null"
                    [attr.aria-label]="'Escolher resposta ' + option.name"
                    tabindex="0"
                    role="button"
                >
                    <div class="option-letter">{{ getOptionLetter(i) }}</div>
                    <div class="option-text">{{ option.name }}</div>
                </div>
            </div>

            <!-- ‚úÖ FEEDBACK -->
            <div *ngIf="showFeedback" class="feedback-section">
                <!-- Status da Resposta -->
                <div class="feedback-status">
                    <h3 *ngIf="isCorrectAnswer(selectedAnswer)" class="feedback-correct">
                        ‚úÖ Correto!
                    </h3>
                    <h3 *ngIf="!isCorrectAnswer(selectedAnswer)" class="feedback-incorrect">
                        ‚ùå Resposta incorreta
                    </h3>
                </div>

                <!-- ‚úÖ EXPLICA√á√ÉO -->
                <div *ngIf="currentQuestion.explanation" class="explanation">
                    <div class="explanation-title">
                        üí° Explica√ß√£o
                    </div>
                    <p>{{ currentQuestion.explanation }}</p>
                </div>

                <!-- ‚úÖ DICA DE ENTREVISTA -->
                <div *ngIf="currentQuestion.interviewTip" class="interview-tip">
                    <div class="interview-tip-title">
                        üéØ Dica para Entrevista
                    </div>
                    <p>{{ currentQuestion.interviewTip }}</p>
                    <button 
                        class="btn btn-secondary btn-listen-tip"
                        (click)="readText(currentQuestion.interviewTip)"
                        title="Ouvir Dica"
                    >
                        üîä Ouvir Dica
                    </button>
                </div>
            </div>

            <!-- ‚úÖ A√á√ïES DO QUIZ -->
            <div class="quiz-actions">
                <!-- Finalizar Agora (s√≥ aparece antes do feedback) -->
                <button 
                    *ngIf="!showFeedback"
                    class="btn btn-secondary btn-finalize" 
                    (click)="finishQuiz()"
                >
                    ‚ùå Finalizar Agora
                </button>
                
                <!-- Pr√≥xima Quest√£o (s√≥ aparece ap√≥s feedback) -->
                <button 
                    *ngIf="showFeedback"
                    class="btn btn-primary btn-next" 
                    (click)="nextQuestion()"
                >
                    {{ questionIndex === questions.length - 1 ? 'üèÅ Finalizar Quiz' : '‚û°Ô∏è Pr√≥xima Quest√£o' }}
                </button>
            </div>
        </div>
    </div>

    <!-- ‚úÖ RESULTADO FINAL -->
    <div *ngIf="finished && quizResult" class="quiz-result">
        <h2 class="result-title">üéâ Quiz Finalizado!</h2>
        
        <!-- Pontua√ß√£o Principal -->
        <div class="result-score">{{ quizResult.percentage }}%</div>
        
        <p class="result-message">
            Voc√™ acertou {{ quizResult.score }} de {{ quizResult.total }} quest√µes!
        </p>

        <!-- Estat√≠sticas Detalhadas -->
        <div class="result-details">
            <div class="result-stat">
                <span class="stat-number">{{ quizResult.score }}</span>
                <span class="stat-label">Acertos</span>
            </div>
            
            <div class="result-stat">
                <span class="stat-number">{{ quizResult.total - quizResult.score }}</span>
                <span class="stat-label">Erros</span>
            </div>
            
            <div class="result-stat">
                <span class="stat-number">{{ quizResult.percentage }}%</span>
                <span class="stat-label">Desempenho</span>
            </div>
        </div>

        <!-- ‚úÖ RESULTADOS POR CATEGORIA -->
        <div *ngIf="quizResult.categoryResults.length > 0" class="category-results">
            <h3 class="category-results-title">üìä Desempenho por Categoria</h3>
            <div class="category-grid">
                <div 
                    *ngFor="let categoryResult of quizResult.categoryResults"
                    class="category-card"
                >
                    <h4 class="category-name">
                        {{ getCategoryTitle(categoryResult.category) }}
                    </h4>
                    <div class="category-percentage">
                        {{ categoryResult.percentage }}%
                    </div>
                    <div class="category-details">
                        {{ categoryResult.correct }}/{{ categoryResult.total }} quest√µes
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚úÖ A√á√ïES FINAIS -->
        <div class="result-actions">
            <button class="btn btn-primary" (click)="restartQuiz()">
                üîÑ Jogar Novamente
            </button>
            <button class="btn btn-secondary" (click)="goHome()">
                üè† Voltar ao In√≠cio
            </button>
        </div>
    </div>

    <!-- ‚úÖ LOADING -->
    <div *ngIf="!finished && !currentQuestion" class="quiz-loading">
        <div class="loading-spinner"></div>
        <h2>Carregando quiz...</h2>
        <p>Preparando suas quest√µes...</p>
    </div>

</div>

